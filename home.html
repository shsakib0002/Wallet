<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <!-- Google Client ID Configuration -->
    <meta name="google-signin-client_id" content="YOUR_GOOGLE_CLIENT_ID_HERE">
    <title>ProWallet</title>
    <meta name="description" content="Offline-first Wallet with Google Sheets Sync">
    
    <!-- Google Identity Services -->
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    
    <!-- Stylesheet -->
    <link rel="stylesheet" href="styles.css">
</head>
<body>

    <!-- 1. AUTH SCREEN (App PIN) -->
    <div id="auth-screen">
        <div class="auth-box">
            <div style="font-size: 48px; margin-bottom: 20px; color: var(--primary-dark);">üîí</div>
            <h2 id="auth-title" style="margin-bottom: 8px;">Setup Security PIN</h2>
            <p class="text-light" style="margin-bottom: 30px;">Secure your financial data</p>
            
            <div class="pin-dots">
                <div class="pin-dot"></div>
                <div class="pin-dot"></div>
                <div class="pin-dot"></div>
                <div class="pin-dot"></div>
            </div>

            <div class="pin-pad">
                <button class="pin-btn" onclick="Auth.enter(1)">1</button>
                <button class="pin-btn" onclick="Auth.enter(2)">2</button>
                <button class="pin-btn" onclick="Auth.enter(3)">3</button>
                <button class="pin-btn" onclick="Auth.enter(4)">4</button>
                <button class="pin-btn" onclick="Auth.enter(5)">5</button>
                <button class="pin-btn" onclick="Auth.enter(6)">6</button>
                <button class="pin-btn" onclick="Auth.enter(7)">7</button>
                <button class="pin-btn" onclick="Auth.enter(8)">8</button>
                <button class="pin-btn" onclick="Auth.enter(9)">9</button>
                <div></div>
                <button class="pin-btn" onclick="Auth.enter(0)">0</button>
                <button class="pin-btn" style="background:transparent; border:1px solid #eee;" onclick="Auth.clear()">‚å´</button>
            </div>
        </div>
    </div>

    <!-- 2. APP CONTAINER -->
    <div id="app" style="display:none;">
        
        <!-- Sidebar -->
        <aside>
            <div class="brand">üí≥ ProWallet</div>
            <a class="nav-item active" onclick="Router.go('dashboard')">üìä Dashboard</a>
            <a class="nav-item" onclick="Router.go('transactions')">üí≥ Transactions</a>
            <a class="nav-item" onclick="Router.go('analytics')">üìà Analytics</a>
            <a class="nav-item" onclick="Router.go('accounts')">üè¶ Accounts</a>
            <div style="margin-top: auto;"></div>
            <a class="nav-item" onclick="Router.go('settings')">‚öôÔ∏è Settings</a>
        </aside>

        <!-- Main Content Area -->
        <main id="main-view">
            <!-- Views injected here via JS -->
        </main>

        <!-- Hidden Print Container (Visible only on Print) -->
        <div id="print-area">
            <div class="print-header">
                <h2>Financial Report</h2>
                <p id="print-date">Date: </p>
            </div>
            <table class="print-table">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Type</th>
                        <th>Category</th>
                        <th>Account</th>
                        <th class="text-right">Amount</th>
                    </tr>
                </thead>
                <tbody id="print-body"></tbody>
            </table>
            <div style="margin-top: 30px; text-align: center; font-size: 12px; color: #888;">
                Generated by ProWallet | Offline Mode
            </div>
        </div>

        <!-- Floating Action Button -->
        <div id="fab" onclick="App.openTxModal()">+</div>

        <!-- Mobile Navigation -->
        <nav class="mobile-nav">
            <div class="nav-item" onclick="Router.go('dashboard')">üìä</div>
            <div class="nav-item" onclick="Router.go('transactions')">üí≥</div>
            <div class="nav-item" onclick="Router.go('analytics')">üìà</div>
            <div class="nav-item" onclick="Router.go('settings')">‚öôÔ∏è</div>
        </nav>
    </div>

    <!-- 3. MODALS -->

    <!-- Transaction Modal -->
    <div id="modal-tx" class="modal-overlay">
        <div class="modal">
            <div class="modal-header">Add Transaction</div>
            <div class="modal-body">
                <div style="display:flex; gap:10px; margin-bottom:15px;">
                    <button id="btn-exp" class="btn btn-outline" style="flex:1" onclick="App.setTxType('expense')">Expense</button>
                    <button id="btn-inc" class="btn btn-outline" style="flex:1" onclick="App.setTxType('income')">Income</button>
                    <button id="btn-trf" class="btn btn-outline" style="flex:1" onclick="App.setTxType('transfer')">Transfer</button>
                </div>
                <form onsubmit="App.submitTx(event)">
                    <label class="text-light">Amount (‡ß≥)</label>
                    <input type="number" id="inp-amt" step="0.01" required placeholder="0.00" inputmode="decimal">
                    
                    <label class="text-light">Date</label>
                    <input type="date" id="inp-date" required>

                    <div id="fields-cat">
                        <label class="text-light">Category</label>
                        <select id="inp-cat" onchange="App.updateSub()"></select>
                        <label class="text-light">Sub-category</label>
                        <select id="inp-sub"></select>
                    </div>

                    <label class="text-light">Account (From)</label>
                    <select id="inp-acc-from"></select>

                    <div id="fields-to" style="display:none;">
                        <label class="text-light">Account (To)</label>
                        <select id="inp-acc-to"></select>
                    </div>

                    <label class="text-light">Note</label>
                    <input type="text" id="inp-note" placeholder="Details...">
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="App.closeModals()">Cancel</button>
                <button class="btn btn-primary" onclick="document.querySelector('#modal-tx form').dispatchEvent(new Event('submit'))">Save Transaction</button>
            </div>
        </div>
    </div>

    <!-- Account Modal -->
    <div id="modal-acc" class="modal-overlay">
        <div class="modal">
            <div class="modal-header">Add Account</div>
            <div class="modal-body">
                <form onsubmit="App.submitAcc(event)">
                    <label class="text-light">Account Name</label>
                    <input type="text" id="acc-name" required placeholder="e.g., DBBL Savings">
                    
                    <label class="text-light">Type</label>
                    <select id="acc-type">
                        <option value="Cash">Cash</option>
                        <option value="Bank">Bank</option>
                        <option value="Mobile">Mobile Wallet</option>
                    </select>
                    
                    <label class="text-light">Initial Balance</label>
                    <input type="number" id="acc-bal" step="0.01" required value="0">
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="App.closeModals()">Cancel</button>
                <button class="btn btn-primary" onclick="document.querySelector('#modal-acc form').dispatchEvent(new Event('submit'))">Add Account</button>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="modal-set" class="modal-overlay">
        <div class="modal">
            <div class="modal-header">Settings & Sync</div>
            <div class="modal-body">
                
                <!-- Google Sync Section -->
                <h3 style="font-size:14px; margin-bottom:10px; color:var(--text-main);">‚òÅÔ∏è Google Sheets Backup</h3>
                <div style="background: #f9f9f9; padding: 15px; border-radius: 4px; border: 1px solid #eee; margin-bottom: 20px;">
                    
                    <div id="g-auth-section">
                        <p class="text-light" style="margin-bottom:10px; line-height:1.4;">Backup your data securely to your personal Google Sheets.</p>
                        <button id="btn-g-login" class="btn btn-google" onclick="GoogleAuth.signIn()">
                            <img src="https://upload.wikimedia.org/wikipedia/commons/5/53/Google_%22G%22_Logo.svg" width="18" alt="G"> Sign in with Google
                        </button>
                        <button id="btn-g-logout" class="btn btn-outline" style="display:none; margin-top:10px;" onclick="GoogleAuth.signOut()">Sign Out</button>
                    </div>

                    <div id="g-sync-section" style="display:none; border-top:1px solid #ddd; padding-top:15px; margin-top:10px;">
                        <label class="text-light">Sheet ID</label>
                        <input type="text" id="inp-sheet-id" placeholder="1BxiM..." value="">
                        <p class="text-light" style="font-size:11px; color:#666; margin-bottom:10px;">Get ID from your Google Sheet URL.</p>
                        
                        <button class="btn btn-primary" id="btn-sync" onclick="GoogleSync.syncAll()">Sync to Google Sheets</button>
                        <div id="sync-status-msg" style="margin-top:10px; text-align:center; font-size:12px; font-weight:600;"></div>
                    </div>
                </div>

                <!-- Local Actions -->
                <h3 style="font-size:14px; margin-bottom:10px; color:var(--text-main);">üñ®Ô∏è Local Actions</h3>
                <div style="display:grid; gap:10px;">
                    <button class="btn btn-outline" onclick="App.printReport()">Print Report (PDF)</button>
                    <button class="btn btn-danger" onclick="App.reset()">‚ö†Ô∏è Factory Reset</button>
                    <button class="btn btn-outline" onclick="Auth.logout()">üîí Lock App</button>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="App.closeModals()">Close</button>
            </div>
        </div>
    </div>

    <!-- App Logic -->
    <script src="app.js"></script>
</body>
</html>
